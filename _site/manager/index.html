<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>PowerNSX</title>
  <meta name="description" content="A Powershell module for NSX for vSphere">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://vmware.github.io/powernsx/manager/">
  <link rel="alternate" type="application/rss+xml" title="PowerNSX" href="https://vmware.github.io/powernsx/feed.xml">
</head>


  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">

    <a class="site-title" href="/">PowerNSX</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/about/">About</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title"></h1>
  </header>

  <div class="post-content">
    <h1 id="nsx-manager-and-controller-operations">NSX Manager and Controller operations</h1>

<p>PowerNSX provides the ability to configure a deployed NSX Manager. It is possible to use PowerCLI and Get-OvfConfiguration to deploy the NSX Manager OVA to begin the end to end bootstrap.</p>

<h1 id="connecting-to-nsx-manager">Connecting to NSX Manager</h1>

<p>The NSX Manager commands allows the following:</p>

<ul>
  <li>SSO configuration</li>
  <li>vCenter registration</li>
  <li>Syslog settings</li>
</ul>

<p>It requires connection to NSX Manager first. To connect just define the NSX manager and credentials you want to use.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>

PowerCLI C:\&gt; connect-nsxserver nsx-m-01a.corp.local -Username admin -password VMware1!

Version             : 6.2.2
BuildNumber         : 3604087
Credential          : System.Management.Automation.PSCredential
Server              : nsx-m-01a.corp.local
Port                : 443
Protocol            : https
ValidateCertificate : False
VIConnection        : vc-01a.corp.local
DebugLogging        : False
DebugLogFile        : C:\Users\ADMINI~1\AppData\Local\Temp\2\PowerNSXLog-admin@nsx-m-01a.corp.local-2016_08_19_16_16_50.log

</code></pre>
</div>

<p>NSX Manager has been connected to. If NSX Manager has a vCenter already registered to it, PowerNSX is programmed to prompt the user to connect to vCenter.</p>

<h1 id="modifying-manager">Modifying Manager</h1>

<p>Any example below is setting the NSX Manager Syslog service to point to a Syslog server</p>

<div class="highlighter-rouge"><pre class="highlight"><code>

PowerCLI C:\&gt; Set-NsxManager -SyslogServer 192.168.100.254 -SyslogPort 514 -SyslogProtocol TCP

</code></pre>
</div>

<p>Connecting NSX Manager to vCenter is pretty straight forward. A vCenter Username, password, and a defined vCenter server is all that is required.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>#!Powershell

PowerCLI C:\&gt; Set-NsxManager -vCenterServer 'vc-01a.corp.local' -vCenterUserName 'administrator@vsphere.local' -vCenterPassword $password

</code></pre>
</div>

<p>With that NSX is connected to vCenter. Very straight forward.</p>

<h1 id="deploying-controllers">Deploying Controllers</h1>
<p>This deployment of controllers will use an Ip Pool. An IP Pool can be quickly created with New-NsxIpPool.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>

New-NsxIPPool -name Controllers -gateway 192.168.100.1 -prefixlength 24 -StartAddress 192.168.100.201 -EndAddress 192.168.100.203 -DnsServer 192.168.100.10 -DnsSuffix 'corp.local'

objectId           : ipaddresspool-1
objectTypeName     : IpAddressPool
vsmUuid            : 42011E64-766E-616B-0401-5C68CF27B466
nodeId             : 0509160a-0cfb-4cc2-811a-3193e8b45b95
revision           : 1
type               : type
name               : Controller Pool
scope              : scope
clientHandle       :
extendedAttributes :
isUniversal        : false
universalRevision  : 0
totalAddressCount  : 3
usedAddressCount   : 3
usedPercentage     : 100
prefixLength       : 24
gateway            : 192.168.100.1
dnsSuffix          : corp.local
dnsServer1         : 192.168.100.10
dnsServer2         : 192.168.100.10
ipPoolType         : ipv4
ipRanges           : ipRanges
subnetId           : subnet-1

</code></pre>
</div>

<p>With the pool created this will address the Controllers which reference it.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>

$ippool = Get-NsxIpPool 'Controller Pool'

New-NsxController -Cluster $cluster -datastore $datastore -PortGroup $PortGroup -IpPool $IpPool -Password $password

revision                : 0
clientHandle            :
isUniversal             : false
universalRevision       : 0
id                      : controller-1
ipAddress               : 192.168.100.202
status                  : RUNNING
upgradeStatus           : NOT_STARTED
version                 : 6.2.46427
upgradeAvailable        : true
virtualMachineInfo      : virtualMachineInfo
hostInfo                : hostInfo
resourcePoolInfo        : resourcePoolInfo
clusterInfo             : clusterInfo
managedBy               : 42011E64-766E-616B-0401-5C68CF27B466
datastoreInfo           : datastoreInfo
controllerClusterStatus : controllerClusterStatus

</code></pre>
</div>

<p>Here we have created a single controller. We need three controllers.</p>

<p>In the famous scriptures of Python:
“Now did the Lord say, “First thou pullest the Holy Pin. Then thou must count to three. Three shall be the number of the counting and the number of the counting shall be three. Four shalt thou not count, neither shalt thou count two, excepting that thou then proceedeth to three. Five is right out. Once the number three, being the number of the counting, be reached and thou shall hath thy NSX Controller cluster””</p>

<p>Rinse and repeat two more times.</p>

<p>Here we can quickly ascertain the NSX Controller cluster status with Get-NsxController. The Controllers that have just been created are now running on the latest version.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>

PowerCLI C:\&gt; Get-nsxcontroller


revision                : 0
clientHandle            :
isUniversal             : false
universalRevision       : 0
id                      : controller-1
ipAddress               : 192.168.100.202
status                  : RUNNING
upgradeStatus           : NOT_STARTED
version                 : 6.2.46427
upgradeAvailable        : true
virtualMachineInfo      : virtualMachineInfo
hostInfo                : hostInfo
resourcePoolInfo        : resourcePoolInfo
clusterInfo             : clusterInfo
managedBy               : 42011E64-766E-616B-0401-5C68CF27B466
datastoreInfo           : datastoreInfo
controllerClusterStatus : controllerClusterStatus

revision                : 0
clientHandle            :
isUniversal             : false
universalRevision       : 0
id                      : controller-2
ipAddress               : 192.168.100.203
status                  : RUNNING
upgradeStatus           : NOT_STARTED
version                 : 6.2.46427
upgradeAvailable        : true
virtualMachineInfo      : virtualMachineInfo
hostInfo                : hostInfo
resourcePoolInfo        : resourcePoolInfo
clusterInfo             : clusterInfo
managedBy               : 42011E64-766E-616B-0401-5C68CF27B466
datastoreInfo           : datastoreInfo
controllerClusterStatus : controllerClusterStatus

revision                : 0
clientHandle            :
isUniversal             : false
universalRevision       : 0
id                      : controller-3
ipAddress               : 192.168.100.204
status                  : RUNNING
upgradeStatus           : NOT_STARTED
version                 : 6.2.46427
upgradeAvailable        : true
virtualMachineInfo      : virtualMachineInfo
hostInfo                : hostInfo
resourcePoolInfo        : resourcePoolInfo
clusterInfo             : clusterInfo
managedBy               : 42011E64-766E-616B-0401-5C68CF27B466
datastoreInfo           : datastoreInfo
controllerClusterStatus : controllerClusterStatus

</code></pre>
</div>

<h1 id="need-help">Need help?</h1>

<p>For more examples please use get-help command preceding any PowerNSX function. Also use -detailed, -examples, or -full.</p>

  </div>

</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">PowerNSX</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>PowerNSX</li>
          <li><a href="mailto:"></a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/vmware"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">vmware</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/powernsxv"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">powernsxv</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>A Powershell module for NSX for vSphere
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
